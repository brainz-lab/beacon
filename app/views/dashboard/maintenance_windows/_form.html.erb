<%= form_with model: [@project, maintenance_window], url: maintenance_window.persisted? ? dashboard_project_maintenance_window_path(@project, maintenance_window) : dashboard_project_maintenance_windows_path(@project), class: "space-y-6 p-6 rounded-xl", style: "background: #FFFFFE; border: 1px solid #E8E5E0;" do |f| %>
  <% if maintenance_window.errors.any? %>
    <div class="p-4 rounded-lg" style="background: #FEE8E8;">
      <ul class="list-disc pl-5 space-y-1">
        <% maintenance_window.errors.full_messages.each do |message| %>
          <li class="text-[13px]" style="color: #B45555;"><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div>
    <%= f.label :title, class: "block text-[13px] font-medium", style: "color: #1A1A1A;" %>
    <%= f.text_field :title, class: "mt-1 block w-full px-3 py-2 text-[13px] rounded-lg focus:outline-none focus:ring-2", style: "background: #FFFFFE; border: 1px solid #E8E5E0; color: #1A1A1A;", placeholder: "Database Migration" %>
  </div>

  <div>
    <%= f.label :description, class: "block text-[13px] font-medium", style: "color: #1A1A1A;" %>
    <%= f.text_area :description, rows: 3, class: "mt-1 block w-full px-3 py-2 text-[13px] rounded-lg focus:outline-none focus:ring-2", style: "background: #FFFFFE; border: 1px solid #E8E5E0; color: #1A1A1A;", placeholder: "Description of maintenance activities..." %>
  </div>

  <div class="grid grid-cols-2 gap-4">
    <div>
      <%= f.label :starts_at, "Start Time", class: "block text-[13px] font-medium", style: "color: #1A1A1A;" %>
      <%= f.datetime_local_field :starts_at, class: "mt-1 block w-full px-3 py-2 text-[13px] rounded-lg focus:outline-none focus:ring-2", style: "background: #FFFFFE; border: 1px solid #E8E5E0; color: #1A1A1A;" %>
    </div>
    <div>
      <%= f.label :ends_at, "End Time", class: "block text-[13px] font-medium", style: "color: #1A1A1A;" %>
      <%= f.datetime_local_field :ends_at, class: "mt-1 block w-full px-3 py-2 text-[13px] rounded-lg focus:outline-none focus:ring-2", style: "background: #FFFFFE; border: 1px solid #E8E5E0; color: #1A1A1A;" %>
    </div>
  </div>

  <div>
    <%= f.label :timezone, class: "block text-[13px] font-medium", style: "color: #1A1A1A;" %>
    <%= f.select :timezone, ActiveSupport::TimeZone.all.map { |tz| [tz.to_s, tz.name] },
        {}, class: "mt-1 block w-full px-3 py-2 text-[13px] rounded-lg focus:outline-none focus:ring-2", style: "background: #FFFFFE; border: 1px solid #E8E5E0; color: #1A1A1A;" %>
  </div>

  <div class="pt-6" style="border-top: 1px solid #E8E5E0;">
    <h4 class="text-[14px] font-medium mb-4" style="color: #1A1A1A;">Affected Monitors</h4>

    <div class="space-y-3">
      <div class="flex items-center gap-2">
        <%= f.check_box :affects_all_monitors, class: "h-4 w-4 rounded", style: "border: 1px solid #E8E5E0;", data: { action: "change->maintenance-form#toggleMonitors" } %>
        <%= f.label :affects_all_monitors, "All monitors", class: "text-[13px]", style: "color: #6B6760;" %>
      </div>

      <div id="monitor-select" class="<%= 'hidden' if maintenance_window.affects_all_monitors %>">
        <%= f.label :monitor_ids, "Select specific monitors", class: "block text-[13px] font-medium mb-2", style: "color: #1A1A1A;" %>
        <div class="max-h-48 overflow-y-auto p-3 rounded-lg space-y-2" style="border: 1px solid #E8E5E0;">
          <% @available_monitors.each do |monitor| %>
            <div class="flex items-center gap-2">
              <%= check_box_tag "maintenance_window[monitor_ids][]", monitor.id, maintenance_window.monitor_ids.include?(monitor.id), class: "h-4 w-4 rounded", style: "border: 1px solid #E8E5E0;", id: "monitor_#{monitor.id}" %>
              <%= label_tag "monitor_#{monitor.id}", monitor.name, class: "text-[13px]", style: "color: #6B6760;" %>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  </div>

  <div class="pt-6" style="border-top: 1px solid #E8E5E0;">
    <h4 class="text-[14px] font-medium mb-4" style="color: #1A1A1A;">Notifications</h4>

    <div class="space-y-3">
      <div class="flex items-center gap-2">
        <%= f.check_box :notify_subscribers, class: "h-4 w-4 rounded", style: "border: 1px solid #E8E5E0;" %>
        <%= f.label :notify_subscribers, "Notify status page subscribers", class: "text-[13px]", style: "color: #6B6760;" %>
      </div>

      <div>
        <%= f.label :notify_before_minutes, "Send notification", class: "block text-[13px] font-medium", style: "color: #1A1A1A;" %>
        <%= f.select :notify_before_minutes, [["30 minutes before", 30], ["1 hour before", 60], ["2 hours before", 120], ["24 hours before", 1440]],
            {}, class: "mt-1 block w-full px-3 py-2 text-[13px] rounded-lg focus:outline-none focus:ring-2", style: "background: #FFFFFE; border: 1px solid #E8E5E0; color: #1A1A1A;" %>
      </div>
    </div>
  </div>

  <div class="flex justify-end gap-3 pt-4">
    <%= link_to "Cancel", dashboard_project_maintenance_windows_path(@project), class: "px-4 py-2 text-[13px] font-medium rounded-lg transition-colors", style: "background: #FFFFFE; border: 1px solid #E8E5E0; color: #1A1A1A;" %>
    <%= f.submit maintenance_window.persisted? ? "Update" : "Schedule Maintenance", class: "px-4 py-2 text-[13px] font-medium rounded-lg cursor-pointer transition-colors", style: "background: #1A1A1A; color: #FFFFFE;" %>
  </div>
<% end %>
